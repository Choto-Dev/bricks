{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "editor",
  "type": "registry:component",
  "title": "Editor",
  "description": "A tiptap editor.",
  "dependencies": [
    "@tiptap/core@3.13.0",
    "@tiptap/react@3.13.0",
    "@tiptap/starter-kit@3.13.0"
  ],
  "registryDependencies": [
    "button"
  ],
  "files": [
    {
      "path": "src/registry/bricks/tiptap-editor/components/editor.tsx",
      "content": "\"use client\";\r\n\r\nimport type { Editor as EditorType, JSONContent } from \"@tiptap/core\";\r\nimport { EditorContent, useEditor } from \"@tiptap/react\";\r\nimport StarterKit from \"@tiptap/starter-kit\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\nimport {\r\n  Bold,\r\n  Code,\r\n  Italic,\r\n  List,\r\n  ListOrdered,\r\n  Strikethrough,\r\n  Underline,\r\n} from \"lucide-react\";\r\nimport React from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ntype TEditorContent = JSONContent | string;\r\ntype EditorContextProps = {\r\n  editor: EditorType | null;\r\n  initialContent: TEditorContent;\r\n  setInitialContent: React.Dispatch<React.SetStateAction<string | JSONContent>>;\r\n  currentContent: TEditorContent;\r\n};\r\nconst EditorContext = React.createContext<EditorContextProps>({\r\n  editor: null,\r\n  initialContent: \"\",\r\n  setInitialContent: (content: TEditorContent) => content,\r\n  currentContent: \"\",\r\n});\r\nexport function useEditorContext() {\r\n  const ctx = React.use(EditorContext);\r\n  return ctx;\r\n}\r\n\r\nfunction getExtensions() {\r\n  return [StarterKit];\r\n}\r\n\r\nfunction EditorRoot({ children }: { children: React.ReactNode }) {\r\n  const [initialContent, setInitialContent] =\r\n    React.useState<TEditorContent>(\"\");\r\n  const [currentContent, setCurrentContent] =\r\n    React.useState<TEditorContent>(\"\");\r\n\r\n  const editor = useEditor(\r\n    {\r\n      extensions: getExtensions(),\r\n      immediatelyRender: false,\r\n      content: initialContent,\r\n      onUpdate: async ({ editor }) => {\r\n        setCurrentContent(editor.getJSON());\r\n      },\r\n    },\r\n    [initialContent],\r\n  );\r\n\r\n  if (!editor) {\r\n    return null;\r\n  }\r\n\r\n  const value = {\r\n    editor,\r\n    initialContent,\r\n    setInitialContent,\r\n    currentContent,\r\n  };\r\n\r\n  return <EditorContext value={value}>{children}</EditorContext>;\r\n}\r\n\r\nconst editorContentStyleVariant = cva(\r\n  \"[&>.ProseMirror]:focus-visible:border-none [&>.ProseMirror]:focus-visible:shadow-none [&>.ProseMirror]:focus-visible:outline-none\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"[&_blockquote]:my-2.5 [&_blockquote]:border-muted-foreground [&_blockquote]:border-l-4 [&_blockquote]:px-5 [&_blockquote]:py-2.5 [&_code]:bg-muted [&_code]:px-1 [&_code]:font-mono [&_em]:italic [&_h1]:font-bold [&_h1]:text-6xl [&_h2]:font-semibold [&_h2]:text-4xl [&_h3]:font-semibold [&_h3]:text-3xl [&_h4]:font-semibold [&_h4]:text-2xl [&_h5]:font-semibold [&_h5]:text-xl [&_h6]:font-semibold [&_h6]:text-lg [&_hr]:border-muted-foreground [&_ol]:list-decimal [&_s]:line-through [&_strong]:font-bold [&_u]:underline [&_ul]:list-disc\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\ntype EditorEditorProps = React.ComponentPropsWithRef<\"div\"> &\r\n  VariantProps<typeof editorContentStyleVariant> & {\r\n    content?: TEditorContent;\r\n    onContentUpdate?: (content: TEditorContent) => void;\r\n  };\r\nfunction EditorEditor({\r\n  content,\r\n  onContentUpdate,\r\n  className,\r\n  variant,\r\n  ...props\r\n}: EditorEditorProps) {\r\n  const { editor, currentContent, initialContent, setInitialContent } =\r\n    useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.Editor should be in Editor.Root\");\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    if (content) {\r\n      setInitialContent(content);\r\n    }\r\n  }, [content, setInitialContent]);\r\n\r\n  React.useEffect(() => {\r\n    if (onContentUpdate) {\r\n      onContentUpdate(currentContent ? currentContent : initialContent);\r\n    }\r\n  }, [onContentUpdate, currentContent, initialContent]);\r\n\r\n  return (\r\n    <EditorContent\r\n      editor={editor}\r\n      className={cn(\r\n        editorContentStyleVariant({\r\n          variant,\r\n          className,\r\n        }),\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\ntype EditorReadOnlyProps = React.ComponentPropsWithRef<\"div\"> &\r\n  VariantProps<typeof editorContentStyleVariant>;\r\nfunction EditorReadOnly({ className, variant, ...props }: EditorReadOnlyProps) {\r\n  const ctx = useEditorContext();\r\n\r\n  if (!ctx || !ctx.editor) {\r\n    throw new Error(\"Editor.ReadOnly should be in Editor.Root\");\r\n  }\r\n\r\n  const editor = useEditor(\r\n    {\r\n      extensions: getExtensions(),\r\n      immediatelyRender: false,\r\n      content:\r\n        typeof ctx.currentContent === \"string\"\r\n          ? ctx.initialContent\r\n          : ctx.currentContent,\r\n      editable: false,\r\n    },\r\n    [ctx],\r\n  );\r\n\r\n  if (editor === null) {\r\n    return <div className=\"text-destructive\">Editor failed to initiate</div>;\r\n  }\r\n\r\n  return (\r\n    <EditorContent\r\n      editor={editor}\r\n      className={cn(\r\n        editorContentStyleVariant({\r\n          variant,\r\n          className,\r\n        }),\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\n// ========================\r\n// ==== Toggle Buttons ====\r\n// ========================\r\ntype EditorToggleBoldBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleBoldBtn(props: EditorToggleBoldBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleBoldBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"bold\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleBold().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <Bold className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype EditorToggleItalicBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleItalicBtn(props: EditorToggleItalicBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleItalicBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"italic\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleItalic().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <Italic className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype EditorToggleUnderlineBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleUnderlineBtn(props: EditorToggleUnderlineBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleUnderlineBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"underline\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleUnderline().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <Underline className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype EditorToggleStrikeBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleStrikeBtn(props: EditorToggleStrikeBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleStrikeBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"strike\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleStrike().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <Strikethrough className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype EditorToggleCodeBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleCodeBtn(props: EditorToggleCodeBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleCodeBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"code\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleCode().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <Code className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype EditorToggleBulletListBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleBulletListBtn(props: EditorToggleBulletListBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleBulletListBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"bulletList\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleBulletList().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <List className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype EditorToggleOrderedListBtnProps = React.ComponentPropsWithRef<\"button\">;\r\nfunction EditorToggleOrderedListBtn(props: EditorToggleOrderedListBtnProps) {\r\n  const { editor } = useEditorContext();\r\n\r\n  if (!editor) {\r\n    throw new Error(\"Editor.ToggleOrderedListBtn should be in Editor.Root\");\r\n  }\r\n\r\n  return (\r\n    <Button\r\n      variant={editor.isActive(\"orderedList\") ? \"default\" : \"outline\"}\r\n      size={\"icon-sm\"}\r\n      className={cn(\"cursor-pointer\", props.className)}\r\n      onClick={() => {\r\n        editor.chain().focus().toggleOrderedList().run();\r\n      }}\r\n      {...props}\r\n    >\r\n      <ListOrdered className=\"size-4\" />\r\n    </Button>\r\n  );\r\n}\r\n\r\nconst Root = EditorRoot;\r\nconst Editor = EditorEditor;\r\nconst ReadOnly = EditorReadOnly;\r\nconst ToggleBoldBtn = EditorToggleBoldBtn;\r\nconst ToggleItalicBtn = EditorToggleItalicBtn;\r\nconst ToggleUnderlineBtn = EditorToggleUnderlineBtn;\r\nconst ToggleStrikeBtn = EditorToggleStrikeBtn;\r\nconst ToggleCodeBtn = EditorToggleCodeBtn;\r\nconst ToggleBulletListBtn = EditorToggleBulletListBtn;\r\nconst ToggleOrderedListBtn = EditorToggleOrderedListBtn;\r\n\r\nexport {\r\n  Root,\r\n  Editor,\r\n  ReadOnly,\r\n  ToggleBoldBtn,\r\n  ToggleItalicBtn,\r\n  ToggleUnderlineBtn,\r\n  ToggleStrikeBtn,\r\n  ToggleCodeBtn,\r\n  ToggleBulletListBtn,\r\n  ToggleOrderedListBtn,\r\n};\r\n",
      "type": "registry:component",
      "target": "components/bricks/tiptap-editor/editor.tsx"
    }
  ]
}